<?xml version="1.0" encoding="UTF-8" ?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
    xmlns:calli="http://callimachusproject.org/rdf/2009/framework#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#">
<head>
    <title>Invite a New User</title>
    <script type="text/javascript"><![CDATA[
    jQuery(function($) {
        $('#message').val($('#message').val().replace(/@@REGISTRATION_URL@@/g, window.location.protocol + '//' + window.location.host + '/?register'));
        var messageChanged = false;
        $('#message').change(function(){
            messageChanged = true;
        });
        $('#label').on('change keyup blur', function() {
            if (!messageChanged) {
                var salutation = $(this).val() ? 'Hello ' + $(this).val() : 'Hello';
                $('#message').val($('#message').val().replace(/(^|[\r\n])Hello[^\r\n]*/, '$1' + salutation + ','));
            }
        });
        $('#email').change(function(){
            if (this.value.indexOf('<') >= 0) {
                var name = this.value.substring(0, this.value.indexOf('<')).replace(/^\s+/,'').replace(/\s+$/,'');
                if (name) {
                    $('#label').val(name).change();
                }
                $(this).val(this.value.replace(/.*</, '').replace(/>.*/, '')).change();
            }
            if (this.value.indexOf('@') > 0 && !$('#name').val()) {
                $('#name').val(this.value.substring(0, this.value.indexOf('@')));
            }
        });
    }); // ]]>
    </script>
</head>
<body>
    <div id="sidebar">
        <aside>
            <p>The username cannot be changed once the user is created</p>
            <p>E-mail address is used to send an invite and possibly reset the password</p>
            <p>Provide the user's full name</p>
            <p>Provide any additional contact information or affiliation information</p>
            <p>You can customize the message sent in the email here</p>
        </aside>
    </div>
    <form id="form" method="POST" action="" enctype="multipart/form-data" autocomplete="off"
            onsubmit="return calli.saveResourceAs(event,calli.slugify($('#name').val()))">
        <fieldset>
            <div class="control-group">
                <label for="email" class="control-label">E-mail address</label>
                <div class="controls">
                    <input id="email" name="email" type="email" class="auto-expand" required="required" autofocus="autofocus" />
                </div>
            </div>
            <div class="control-group">
                <label for="name" class="control-label">Username</label>
                <div class="controls">
                    <input id="name" name="name" type="text" class="auto-expand" required="required" />
                </div>
            </div>
        </fieldset>
        <fieldset>
            <div class="control-group">
                <label for="label" class="control-label">Full name</label>
                <div class="controls">
                    <input id="label" name="label" type="text" class="auto-expand" required="required" />
                </div>
            </div>
            <div class="control-group">
                <label for="comment" class="control-label">Additional information</label>
                <div class="controls">
                    <textarea id="comment" class="auto-expand" name="comment"></textarea>
                </div>
            </div>
        </fieldset>
        <hr />
        <fieldset>
            <div class="control-group">
                <label for="subject" class="control-label">Welcome subject</label>
                <div class="controls">
                    <input id="subject" name="subject" type="text" class="auto-expand" required="required" value="Account Registration" />
                </div>
            </div>
            <div class="control-group">
                <label for="message" class="control-label">Welcome message</label>
                <div class="controls">
                    <textarea id="message" class="auto-expand" required="required" name="message">Hello,

A new account has been created for you. Use the link below to pick a
password or other authentication options.

@@REGISTRATION_URL@@

Enjoy!
</textarea>
                </div>
            </div>
            <div class="form-actions">
                <button id="invite" type="submit" class="btn btn-primary">Invite</button>
            </div>
        </fieldset>
    </form>
</body>
</html>
