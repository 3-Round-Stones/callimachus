<?xml version="1.0" encoding="UTF-8" ?>
<?xml-stylesheet type="text/xsl" href="/callimachus/template.xsl"?>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Import Folder Contents</title>
    <script type="text/javascript">
    // <![CDATA[
    jQuery(function($){
        window.deleteFolder = function(event,redirect) {
            if (!confirm("Are you sure you want to delete the contents of this folder?"))
                return false;
            var xhr = $.ajax({
                type: 'DELETE',
                url: '?archive', 
                beforeSend: function(xhr){
                    var lastmod = getLastModified();
                    if (lastmod) {
                        xhr.setRequestHeader("If-Unmodified-Since", lastmod);
                    }
                    withCredentials(xhr);
                }, success: function(data, textStatus) {
                    location.replace(redirect);
                }
            });
        }
        function withCredentials(req) {
            try {
                req.withCredentials = true;
            } catch (e) {}
        }

        function getLastModified() {
            try {
                var committedOn = $('#resource-lastmod').find('[property=audit:committedOn]').attr('content');
                return new Date(committedOn).toGMTString();
            } catch (e) {
                return null;
            }
        }
    });
    // ]]>
    </script>
</head>
<body>
    <h1>Import Folder Contents</h1>
    <div id="sidebar">
        <aside>
            <p>Upload a CAR file that was previously exported from another Callimachus folder</p>
        </aside>
    </div>
    <form id="form" method="POST" action="" enctype="multipart/form-data">
        <fieldset>
            <div class="control-group">
                <label for="image" class="control-label">Content</label>
                <div class="controls">
                    <input type="file" id="file" name="file" multiple="multiple" />
                </div>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary" id="import">Import</button>
                <button type="button" id="cancel" onclick="location.replace('?view')" class="btn">Cancel</button>
                <button type="button" id="delete" onclick="deleteFolder(event,'?view')" class="btn btn-danger">Delete</button>
            </div>
        </fieldset>
    </form>
</body>
</html>
