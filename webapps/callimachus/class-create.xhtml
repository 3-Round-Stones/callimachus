<?xml version="1.0" encoding="UTF-8" ?>
<?xml-stylesheet type="text/xsl" href="/callimachus/manifest?template"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
	xmlns:owl="http://www.w3.org/2002/07/owl#" xmlns:calli="http://callimachusproject.org/rdf/2009/framework#"
	xmlns:foaf="http://xmlns.com/foaf/0.1/">
<head>
	<title>New Class</title>
	<link rel="group" href="/group/users" />
	<link rel="group" href="/group/staff" />
	<link rel="group" href="/group/admin" />
	<link rel="viewable" href="/callimachus/Viewable" />
	<link rel="editable" href="/callimachus/Editable" />
	<link rel="composite" href="/callimachus/Composite" />
	<script type="text/javascript"> // <![CDATA[
	jQuery(function($){
		$('#create').bind('calliLinked', function() {
			$('link[rel="group"]').each(function(){
				var de = jQuery.Event('calliLink');
				de.location = this.href;
				$('#authors').trigger(de);
			});
		});
		$('#view').bind('calliLinked', function() {
			$('link[rel="viewable"]').each(function(){
				var de = jQuery.Event('calliLink');
				de.location = this.href;
				$('#subClassOf').trigger(de);
			});
		});
		$('#edit').bind('calliLinked', function() {
			$('link[rel="editable"]').each(function(){
				var de = jQuery.Event('calliLink');
				de.location = this.href;
				$('#subClassOf').trigger(de);
			});
		});
		$('#composite').click(function(){
			$('link[rel="composite"]').each(function(){
				var composite = $('#subClassOf').find('[about$="' + this.href + '"]');
				if ($('#composite').is(':checked')) {
					if (!composite.length) {
						var de = jQuery.Event('calliLink');
						de.location = this.href;
						$('#subClassOf').trigger(de);
					}
				} else {
					composite.remove();
				}
			});
		});
		$(document).bind('DOMNodeInserted', function(event) {
			var label = $('.equivalentLabel', event.target).text();
			var comment = $('.equivalentComment', event.target).text();
			if (label && !$('#label').val()) {
				$('#label').val(label);
				$('#label').change();
			}
			if (comment && !$('#comment').val()) {
				$('#comment').val(comment);
				$('#comment').change();
			}
		});
	}); // ]]>
	</script>
	<script type="text/javascript">//<![CDATA[
		function updateAbout() {
			var label = $('#label').val();
			label = label.replace(/([a-z])\s([A-Z])/g, '$1$2');
			var local = encodeURI(label).replace(/%20/g,'_');
			$('#form').attr('about', local);
			return true;
		}
		// ]]>
	</script>
</head>
<body>
	<h1>New Class</h1>
	<div id="sidebar">
		<ul class="aside">
			<li>A class usually represents a noun, such as a person, place or (possibly quite abstract) thing</li>
			<li>Icon is used when looking up resources</li>
			<li>To add an icon, click the browse icon to open a file upload dialogue</li>
			<li>Authors are permitted to create new resources of this class</li>
			<li>Use a super class to inherit or override page templates</li>
			<li>An external OWL class can be associated with a Callimachus class to apply the templates to both classes</li>
			<li>Use the equivalent dialogue to upload and view an imported ontology; drag the external OWL class onto the equivalent field to make the association</li>
			<li>Templates are used for page or form structure on each operation</li>
		</ul>
	</div>
	<form id="form" method="POST" action="" enctype="application/rdf+xml" typeof="owl:Class"
			onsubmit="updateAbout();return calli.saveFormAs(this)">
		<div class="hbox">
			<div>
				<label for="label">Label</label>
				<input id="label" value="{rdfs:label}" class="auto-expand" required="required" autofocus="autofocus" />
			</div>
			<div id="icon" dropzone="link s:text/uri-list">
				<label>Icon <a href="/?view" title="Browse"
						onclick="return calli.selectResource(this)" class="ui-icon ui-icon-folder-open" /></label>
				<div rel="calli:icon">
					<span about="?icon" typeof="foaf:Image" class="ui-state-highlight ui-corner-all">
						<img src="{?icon}" />
						<a href="{?icon}" title="Remove" onclick="return calli.removeResource(this)" class="ui-icon ui-icon-close" />
					</span>
				</div>
			</div>
		</div>
		<div>
			<label for="comment">Comment</label>
			<textarea id="comment" class="auto-expand">{rdfs:comment}</textarea>
		</div>
		<div class="hbox">
			<div id="authors" dropzone="link s:text/uri-list">
				<label>Authors <a href="/callimachus/Group" title="Select Group"
						onclick="return calli.createResource(this)" class="ui-icon ui-icon-newwin" /></label>
				<div rel="calli:author" class="vbox">
					<span about="?author" typeof="calli:Party" class="ui-state-highlight ui-corner-all">
						{rdfs:label}
						<a href="{?author}" title="Remove" onclick="return calli.removeResource(this)" class="ui-icon ui-icon-close" />
					</span>
				</div>
			</div>
			<div id="subClassOf" dropzone="link s:text/uri-list">
				<label>Super <a href="/callimachus/Class" title="Create"
						onclick="return calli.createResource(this)" class="ui-icon ui-icon-newwin" /></label>
				<div rel="rdfs:subClassOf" class="vbox">
					<span about="?subClassOf" typeof="owl:Class" class="ui-state-highlight ui-corner-all">
						{rdfs:label}
						<a href="{?subClassOf}" title="Remove" onclick="return calli.removeResource(this)" class="ui-icon ui-icon-close" />
					</span>
				</div>
			</div>
			<div id="equivalentClass" dropzone="link s:text/uri-list">
				<label>Equivalent <a href="/callimachus/NamedGraph" title="Create"
						onclick="return calli.createResource(this)" class="ui-icon ui-icon-newwin" /></label>
				<div rel="owl:equivalentClass" class="vbox">
					<span about="?equivalentClass" typeof="owl:Class" class="ui-state-highlight ui-corner-all">
						<span class="equivalentLabel">{rdfs:label}</span>
						<span style="display:none" class="equivalentComment">{rdfs:comment}</span>
						<a href="{?equivalentClass}" title="Remove" onclick="return calli.removeResource(this)" class="ui-icon ui-icon-close" />
					</span>
				</div>
			</div>
		</div>
		<div>
			<label for="composite">Nested resources</label>
			<label class="input"><input id="composite" type="checkbox" /> These resources contain other resources</label>
		</div>
		<hr />
		<h2>Page Templates</h2>
		<div class="hbox">
			<div id="create" dropzone="link s:text/uri-list">
				<label>Create template <a href="/callimachus/Page?create#!/callimachus/pages/sample-create.xhtml" title="Create"
						onclick="return calli.createResource(this)" class="ui-icon ui-icon-newwin" /></label>
				<div rel="calli:create">
					<span about="?create" typeof="calli:Page" class="ui-state-highlight ui-corner-all">
						{rdfs:label}
						<a href="{?create}" title="Remove" onclick="return calli.removeResource(this)" class="ui-icon ui-icon-close" />
					</span>
				</div>
			</div>
			<div id="view" dropzone="link s:text/uri-list">
				<label>View template <a href="/callimachus/Page?create#!/callimachus/pages/sample-view.xhtml" title="Create"
						onclick="return calli.createResource(this)" class="ui-icon ui-icon-newwin" /></label>
				<div rel="calli:view">
					<span about="?view" typeof="calli:Page" class="ui-state-highlight ui-corner-all">
						{rdfs:label}
						<a href="{?view}" title="Remove" onclick="return calli.removeResource(this)" class="ui-icon ui-icon-close" />
					</span>
				</div>
			</div>
			<div id="edit" dropzone="link s:text/uri-list">
				<label>Edit template <a href="/callimachus/Page?create#!/callimachus/pages/sample-edit.xhtml" title="Create"
						onclick="return calli.createResource(this)" class="ui-icon ui-icon-newwin" /></label>
				<div rel="calli:edit">
					<span about="?edit" typeof="calli:Page" class="ui-state-highlight ui-corner-all">
						{rdfs:label}
						<a href="{?edit}" title="Remove" onclick="return calli.removeResource(this)" class="ui-icon ui-icon-close" />
					</span>
				</div>
			</div>
		</div>
		<button id="create" type="submit">Create</button>
	</form>
</body>
</html>
