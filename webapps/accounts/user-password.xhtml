<?xml version="1.0" encoding="UTF-8" ?>
<?xml-stylesheet type="text/xsl" href="/layout/template.xsl"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
	xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
	xmlns:calli="http://callimachusproject.org/rdf/2009/framework#"
	xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
	xmlns:foaf="http://xmlns.com/foaf/0.1/">
<head>
	<title about="?this" property="rdfs:label"/>
	<link type="text/css" href="/accounts/jquery.validate.password.css" rel="stylesheet" />	
	<script src="/accounts/jquery.validate.password.js">
	</script>
	<script src="/accounts/md5.js">
	</script>
	<script>//<![CDATA[
		function savePassword() {
			var name = $("#name").text();
			var realm = document.getElementById("realm").href;
			$('#current-encoded').val(hex_md5(name + ':' + realm + ':' + $("#current").val()));
			var value = $("#password").val();
			if (value) {
				$('#password-encoded').val(hex_md5(name + ':' + realm + ':' + value));
			}
			return true;
		}
		jQuery(function($) {
			if (!$('#email').length) {
				$('#email-div').append('<input id="email" name="email" type="text" class="auto-expand required email" />');
			}
			$("#form").validate();
		});
		// ]]>
	</script>
</head>
<body about="?this">
	<ul class="aside">
		<li>Your e-mail address is used to reset your password</li>
		<li><label>Choosing a good password</label>
			<ul>
				<li>Never share your password to colleagues, friends, or family members, even when asked</li>
				<li>Don't choose passwords that relate to you as a person</li>
				<li>Don't use your last name, your spouse's name, the name of your pet, the date of birth, your favourite flower etc.</li>
				<li>Use complex multiple word pass phrases, never a single word</li>
			</ul>
		</li>
	</ul>
	<h1>Change password</h1>
	<div style="display:none">
		<span id="name" property="calli:name" />
		<a id="realm" href="/" />
	</div>
	<form id="form" method="POST" action="?password" autocomplete="off" onsubmit="savePassword()">
		<label for="email">E-mail address</label>
		<div id="email-div" data-cardinality="1">
			<input id="email" name="email" property="calli:email" type="text" class="auto-expand required email" />
		</div>
		<div class="hbox">
			<div>
				<label for="current">Current password</label>
				<input id="current" type="password" class="required" />
				<input id="current-encoded" name="current" type="hidden" />
			</div>
			<div>
				<label for="password">New password</label>
				<div>
					<input id="password" type="password" password="#name" class="password" onkeyup="$(this).valid()" />
					<input id="password-encoded" name="password" type="hidden" />
					<div class="password-meter">
						<label for="password" class="password-meter-message" />
						<div class="password-meter-bg">
							<div class="password-meter-bar"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<button id="submit" type="submit">Save</button>
		<button id="cancel" type="button" onclick="location.replace('?view')">Cancel</button>
	</form>
</body>
</html>
