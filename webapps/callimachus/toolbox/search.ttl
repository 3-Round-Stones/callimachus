@prefix xsd:<http://www.w3.org/2001/XMLSchema#>.
@prefix rdf:<http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix rdfs:<http://www.w3.org/2000/01/rdf-schema#>.
@prefix owl:<http://www.w3.org/2002/07/owl#>.
@prefix skos:<http://www.w3.org/2004/02/skos/core#>.
@prefix skosxl:<http://www.w3.org/2008/05/skos-xl#>.
@prefix foaf:<http://xmlns.com/foaf/0.1/>.
@prefix msg:<http://www.openrdf.org/rdf/2011/messaging#>.
@prefix calli:<http://callimachusproject.org/rdf/2009/framework#>.
@prefix prov:<http://www.w3.org/ns/prov#>.
@prefix keyword:<http://www.openrdf.org/rdf/2011/keyword#>.
@prefix :<#>.

<> a <../SchemaGraph>.

:SearchDescription rdfs:subClassOf msg:Message;
    rdfs:subClassOf [owl:onProperty msg:target; owl:allValuesFrom <../Realm>];
    rdfs:subClassOf [owl:onProperty msg:object; owl:allValuesFrom <java:java.io.InputStream>];
    calli:method "GET";
    calli:query "search";
    calli:rel "search";
    calli:type "application/opensearchdescription+xml";
    calli:script """
        var sb = [];
        sb.push('<?xml version="1.0" encoding="UTF-8"?>');
        sb.push('<OpenSearchDescription xmlns="http://a9.com/-/spec/opensearch/1.1/">');
        sb.push('<ShortName>' + this.rdfsLabel + '</ShortName>');
        sb.push('<Url type="application/atom+xml" template="' + this + '?q={searchTerms}"/>');
        sb.push('</OpenSearchDescription>');
        var xml = sb.join('\\n');
        return new java.io.ByteArrayInputStream(new java.lang.String(xml).getBytes("UTF-8"));
    """.

:SearchFolder rdfs:subClassOf msg:Message;
    rdfs:subClassOf [owl:onProperty msg:target; owl:allValuesFrom <../Realm>];
    rdfs:subClassOf [owl:onProperty msg:object; owl:allValuesFrom <java:java.io.Reader>];
    calli:method "GET";
    calli:query "q";
    calli:realm </>;
    calli:type "text/html";
    calli:header "cache-control:no-store";
    calli:get <../pipelines/search.xpl?result&this=$0&q={qhtml}>.

:qhtml a owl:DatatypeProperty, owl:FunctionalProperty;
    rdfs:domain :SearchFolder;
    rdfs:range xsd:string;
    calli:query "q".

:SearchFolderAtom rdfs:subClassOf msg:Message;
    rdfs:subClassOf [owl:onProperty msg:target; owl:allValuesFrom <../Realm>];
    rdfs:subClassOf [owl:onProperty msg:object; owl:allValuesFrom <java:java.io.InputStream>];
    calli:method "GET";
    calli:query "q";
    calli:realm </>;
    calli:type "application/atom+xml;q=0.1";
    calli:header "cache-control:no-store";
    calli:get <../pipelines/search-atom.xpl?result&this=$0&q={qatom}>.

:qatom a owl:DatatypeProperty, owl:FunctionalProperty;
    rdfs:domain :SearchFolderAtom;
    rdfs:range xsd:string;
    calli:query "q".