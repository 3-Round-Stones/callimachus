<?xml version="1.0" encoding="UTF-8" ?>
<?xml-stylesheet type="text/xsl" href="/layout/template.xsl"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#">
<head>
	<title>Edit Wiki Page</title>
	<script type="text/javascript"><![CDATA[
	jQuery(function($){
		jQuery.get($('body').attr('about'), function(text) {
			$('#textarea').val(text);
			$('#textarea').change();
		});
		var local = $('body').attr('about').replace(/.*\//, '').replace(/\.txt$/, '');
		$('title').text(decodeURIComponent(local));
		$('#form').submit(function(event) {
			jQuery.ajax({
				type: "PUT", url: $('body').attr('about'),
				headers: {'If-Match': $('meta[http-equiv="etag"]').attr('content')},
				contentType: 'text/plain',
				data: $('#textarea').val(),
				success: function() {
					location = "?view";
				}
			});
			event.preventDefault();
			return false;
		});
	});
	]]></script>
</head>
<body about="?this">
	<ul class="aside">
		<li><a href="/callimachus/Image?create" target="_blank">Upload an image</a></li>
	</ul>
	<ul class="aside">
		<li>//italics//</li>
		<li>**bold**</li>
		<li>* Bullet list<br/>* Second item<br/>** Sub item</li>
		<li># Numbered list<br/># Second item<br/>## Sub item</li>
		<li>Link to [[wiki page]]</li>
		<li>[[URL|link name]]</li>
		<li>== Large heading<br/>=== Medium heading<br/>==== Small heading</li>
		<li>No<br/> linebreak!<br/><br/>Use empty line</li>
		<li>Forced\\<br/>linebreak</li>
		<li>Horizontal line:<br/>----</li>
		<li>{{/image/filename.jpg|alt text}}</li>
		<li>|=|=table|=header|<br/>|a|table|row|<br/>|b|table|row|</li>
		<li>{{{<br/>== [[Nowiki]]:<br/> //**don't** format//<br/>}}}</li>
	</ul>
	<form id="form" action="">
		<div>
			<textarea id="textarea" class="auto-expand"></textarea>
		</div>
		<button id="save" type="submit">Save</button>
		<button id="cancel" type="button" onclick="location.replace('?view')">Cancel</button>
		<button id="delete" type="button" onclick="if (confirm('Are you sure you want to delete this page?')) calli.deleteResource();">Delete</button>
	</form>
</body>
</html>
